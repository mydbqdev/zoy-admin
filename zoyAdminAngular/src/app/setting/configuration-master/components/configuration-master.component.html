<ngx-spinner bdColor="rgba(0,0,0,0.8)" size="medium" color="#fff" type="ball-circus" [fullScreen]="true">
  <p style="color: white;">Loading ...</p>
</ngx-spinner>
<div id="page-top">
    <!-- Page Wrapper -->
    <div id="wrapper">    
      <!-- Sidebar -->
        <app-sidebar></app-sidebar>
      <!-- End of Sidebar -->

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column" [ngClass]=" isExpandSideBar ?'side-bar-expand':'side-bar-collaspe'">
            <!-- Main Content -->
            <div id="content">
                <div style="display: block;margin-bottom: 5.375rem;">
                <!-- Topbar -->
                <app-header></app-header>
                <!-- End of Topbar -->
                </div>

                <!-- Begin Page Content -->
                <div class="container-fluid">
                  <div class="d-sm-flex align-items-center justify-content-between mb-0">
                    <h3 class="h3 mb-0"><span class="text-header-800 text-header-border">Master</span><span class="text-header-800-blue">Configuration</span></h3> 
                    <div>
                    </div>
                  </div>
                   <!--
                  <div class="d-flex align-items-center justify-content-between w-100" style="display: block;margin: 0px;padding: 2px;">
                    <div class="input-group w-100">
                      <button type="button" class="form-control btn btn-primary">Advances</button>
                      <button type="button" class="form-control">Security Deposit Limits</button>
                      <button type="button" class="form-control">Cancellation Rules</button>
                      <button type="button" class="form-control">Security Deposite Refund Rules</button>
                      <button type="button" class="form-control">Other Charges</button>
                      <button type="button" class="form-control">Data Grouping</button>-->
                      <!--button type="button" class="form-control">Promotion and Offers</button -->
                  <!--  </div>
                    <i class="fas fa-chevron-right ms-2"></i>
                  </div>
                -->
                </div>
                  <div class="card-body">
                   <div class="card">
                      <div>
                          <!--Total Advance section-->
                          <div class="row p-3 align-items-center marginRow">
                            <div class="col-sm-3">
                              <div><span style="font-size: 16px;">Token Advance (%)</span></div>
                              <div><p class="small text-muted " style="font-size: 12px;"><em>Specify the percentage of the total amount to be collected as a token advance during booking.</em></p></div>
                            </div>
                            
                            <div class="col-sm-9">
                              <div class="row">
                                <div class="col-sm-4">
                                  <div class="input-group input-group-sm">
                                    <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                    <input 
                                      type="text" 
                                      class="form-control form-control-sm" 
                                      [(ngModel)]="configMasterModel.tokenDetails.fixedToken" [disabled]="tokenAdvancDisabled" (keypress)="numberOnly($event)" maxlength="8"
                                       [ngClass]="{'is-invalid': !tokenAdvancDisabled && (configMasterModel.tokenDetails.fixedToken == 0 || !configMasterModel.tokenDetails.fixedToken) }" 
                                      style="max-width: 70px !important;" />
                                  </div>
                                  <p class="small text-muted " style="font-size: 12px;">
                                    <em>Fixed amount of the token advance required during booking.</em>
                                  </p>
                                </div>
                                <div class="col-sm-4">
                                      <div class="input-group input-group-sm" >
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm" 
                                          [(ngModel)]="configMasterModel.tokenDetails.variableToken"  (keypress)="percentageOnly($event)" maxlength="5"
                                          [ngClass]="{'is-invalid': !tokenAdvancDisabled && ( configMasterModel.tokenDetails.variableToken == 0 || !configMasterModel.tokenDetails.variableToken)}" 
                                          style="max-width: 70px !important;" [disabled]="tokenAdvancDisabled" />
                                         <span class="input-group-text">%</span>
                                  </div>
                                  <p class="small text-muted " style="font-size: 12px;"><em>Percentage of the token advance required during booking.</em></p>
                      
                                </div>
                                <div class="col-sm-3">
                                    <div *ngIf="tokenAdvancDisabled">
                                      <button class="btn btn-sm btn-outline-secondary" (click)="tokenAdvancDisabled = false">
                                        <i class="fas fa-edit"></i>
                                      </button>
                                    </div>
                                    <div class="btn-group" *ngIf="!tokenAdvancDisabled">
                                      <button class="btn btn-sm btn-outline-secondary" (click)="tokenAdvancSubmit()">
                                        <i class="fas fa-check"></i>
                                      </button>
                                      <button class="btn btn-sm btn-outline-secondary" (click)="tokenAdvanceReset()">
                                        <i class="fas fa-redo" style="color: red;"></i>
                                      </button>
                                    </div>
                                </div>
                              </div>
                                 </div>
                          </div>
                        </div>
                        <hr class="solid"> 
                        <div>
                          <!--Security deposite Limits-->
                          <div class="row p-3 marginRow">
                            <div class="col-sm-3">
                              <div><span style="font-size: 16px;">Security Deposit Limits</span></div>
                              <div>
                                <p class="small text-muted " style="font-size: 12px;">
                                <em>Configure the minimum and maximum security deposit limits that owners are allowed to collect from tenants.</em>
                                </p>
                              </div>
                            </div>
                            <div class="col-sm-9">
                              <div class="row">
                                <!-- Minimum Security Deposit -->
                                <div class="col-sm-4">
                                  <div>Minimum Security Deposit</div>
                                  <div class="input-group input-group-sm">
                                    <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                    <input 
                                      type="text" 
                                      class="form-control form-control-sm"
                                      [(ngModel)]="configMasterModel.depositDetails.minimumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="9"
                                       [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.minimumDeposit == 0 || !configMasterModel.depositDetails.minimumDeposit) }" 
                                      style="max-width: 140px !important;" />
                                  </div>
                                  <p class="small text-muted" style="font-size: 12px;">
                                  <em>Set the minimum allowed deposit amount.</em>
                                  </p>
                                </div>
                                <!-- Maximum Security Deposit -->
                                <div class="col-sm-4">
                                  <div>Maximum Security Deposit</div>
                                  <div class="input-group input-group-sm">
                                    <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                    <input 
                                      type="text" 
                                      class="form-control form-control-sm"
                                      [(ngModel)]="configMasterModel.depositDetails.maximumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="8"
                                       [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.maximumDeposit == 0 || !configMasterModel.depositDetails.maximumDeposit) }" 
                                      style="max-width: 140px !important;"/>
                                  </div>
                                  <p class="small text-muted" style="font-size: 12px;">
                                  <em>Set the maximum allowed deposit amount.</em>
                                  </p>
                                </div>
                                <!-- Action Button -->
                                <div class="col-sm-3 mt-4">
                                  <div class="btn-group">
                                    <button 
                                      class="btn btn-sm btn-outline-secondary" 
                                      *ngIf="securityDepositLimitsDisabled"
                                      (click)="securityDepositLimitsDisabled = false">
                                      <i class="fas fa-edit"></i>
                                    </button>
                                    <button 
                                      class="btn btn-sm btn-outline-secondary" 
                                      *ngIf="!securityDepositLimitsDisabled"
                                      (click)="securityDepositLimitsSubmit()">
                                      <i class="fas fa-check"></i>
                                    </button>
                                    <button 
                                      class="btn btn-sm btn-outline-secondary" 
                                      *ngIf="!securityDepositLimitsDisabled"
                                      (click)="securityDepositLimitsReset()">
                                      <i class="fas fa-redo" style="color: red;"></i>
                                    </button>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          
                        </div>
                        <hr class="solid"> 
                         <!--Cancellation And Refund Policy-->
                         <div>
                          <div class="row p-3 marginRow">
                            <div class="col-sm-3">
                              <span style="font-size: 16px;">Cancellation And Refund Policy</span>
                              <p class="small text-muted" style="font-size: 12px;"><em>Define the deduction percentage and time frame for cancellation before check in.</em></p>
                            </div>
                            <div class="col-sm-9">
                              <div style="background-color: #c1a1f3; padding: 5px;">
                                    <i class="far mr-2 ml-2" [ngClass]="collaspeListRight[0].selected ? 'fa fa-angle-down':'fa fa-angle-up'" style="cursor: pointer;" data-bs-toggle="collapse" data-bs-target="#collapseExampleRight0" aria-expanded="false" aria-controls="collapseExampleRight0" (click)="collaspeExpandPanelRight(collaspeListRight[0],'right1')"> </i>
                                    Before Check in
                                </div>
                                <div class="collapse show" id="collapseExampleRight0">
                                  <div class="card card-body m-0 p-0">
                                    <div>
                                      <div class="pt-2 pb-2">
                                       <div class="d-flex">
                                        <div style="width: 40px;"></div>
                                        <div class="mr-3" style="width: 80px;">
                                          <div>Condition</div>
                                          <div class="input-group input-group-sm">
                                            <select class="form-select form-select-sm" style="max-width: 80px !important;"  [(ngModel)]="beforeCheckInCRfModel.condName"
                                            [ngClass]="{'is-invalid': beforeCheckInCRfSaveVali && !beforeCheckInCRfModel.condName}" >
                                            <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                            </select>
                                          </div>
                                        </div>
                                            <div class="mr-3" style="width: 155px;">
                                              <div>Before check in</div>
                                              <div class="input-group input-group-sm">
                                                <input 
                                                type="text" 
                                                class="form-control form-control-sm"
                                                [(ngModel)]="beforeCheckInCRfModel.daysBeforeCheckIn" (keypress)="numberOnly($event)" maxlength="3"
                                                [ngClass]="{'is-invalid': beforeCheckInCRfSaveVali && !beforeCheckInCRfModel.daysBeforeCheckIn }" 
                                                style="max-width: 84px !important;"
                                                />
                                                <span class="input-group-text">Days</span>
                                              </div>
                                              <p class="small text-muted" style="font-size: 12px;"><em>Enter maximum days before check in.</em></p>
                                            </div>
                                            <div class="mr-3" style="width: 190px;">
                                              <div>Deduction Type</div>
                                              <div class="input-group input-group-sm">
                                                <select class="form-select form-select-sm" [(ngModel)]="beforeCheckInCRfModel.triggerOn" 
                                                [ngClass]="{'is-invalid': beforeCheckInCRfSaveVali && !beforeCheckInCRfModel.triggerOn}" >
                                                <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                                </select>
                                              </div>
                                            </div>
                                            <div style="width: 160px;">
                                                <div>Deduction</div>
                                                <div class="input-group input-group-sm">
                                                  <input 
                                                  type="text" 
                                                  class="form-control form-control-sm"
                                                  [(ngModel)]="beforeCheckInCRfModel.deductionPercentages" (keypress)="percentageOnlyWithZero($event)" maxlength="5"
                                                  [ngClass]="{'is-invalid': beforeCheckInCRfSaveVali && ( beforeCheckInCRfModel.deductionPercentages == undefined || beforeCheckInCRfModel.deductionPercentages.toString() =='' ) }" 
                                                  style="max-width: 90px !important;"
                                                  />
                                                  <span class="input-group-text">%</span>
                                                 </div>
                                                <p class="small text-muted" style="font-size: 12px;"><em>Percentage of booking amount to deduct.</em></p>
                                            </div>
                                            <div class="ml-1">
                                              <div style="height: 23px;"></div>
                                              <div>
                                                <button type="button" class="btn btn-sm btn-primary" (click)="beforeCheckInCRfAdd()" >Add</button>
                                              </div>
                                            </div>
                                        </div>
                                      </div>
                                      <div >
                                        <!-- <div class="row mb-1" *ngFor="let bci of mockCancellationDetails ; let n=index;"
                                        cdkDrag class="draggable-row" cdkDropList (cdkDropListDropped)="onDrop($event)">
                                          <div class="col-sm-2">
                                            <div class="input-group input-group-sm" *ngIf="bci.bcicrDisable">
                                              <input type="text" class="form-control form-control-sm" value="==" [disabled]="bci.bcicrDisable" /> 
                                            </div> 
                                            <div class="input-group input-group-sm" *ngIf="!bci.bcicrDisable">
                                              <select class="form-select form-select-sm" style="max-width: 100px !important;">
                                              <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                              </select>
                                            </div>
                                          </div>
                                          <div class="col-sm-3">
                                           <div class="input-group input-group-sm">
                                              <input 
                                                type="text" 
                                                class="form-control form-control-sm"
                                                [(ngModel)]="bci.daysBeforeCheckIn" (keypress)="numberOnly($event)" maxlength="3" [disabled]="bci.bcicrDisable"
                                                [ngClass]="{'is-invalid': !bci.bcicrDisable && (bci.daysBeforeCheckIn == 0 || !bci.daysBeforeCheckIn) }" 
                                                style="max-width: 100px !important;"
                                                />
                                                <span class="input-group-text">Days</span>
                                            </div>
                                           </div>
                                           <div class="col-sm-3">
                                            <div class="input-group input-group-sm" *ngIf="bci.bcicrDisable">
                                              <input type="text" class="form-control form-control-sm" value="PaidAmount & Rent" [disabled]="bci.bcicrDisable" /> 
                                            </div>
                                            <div class="input-group input-group-sm" *ngIf="!bci.bcicrDisable">
                                              <select class="form-select form-select-sm">
                                              <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                              </select>
                                            </div>
                                          </div>
                                           <div class="col-sm-3">                   
                                             <div class="input-group input-group-sm">
                                              <input 
                                              type="text" 
                                              class="form-control form-control-sm"
                                              [(ngModel)]="bci.deductionPercentages" (keypress)="percentageOnlyWithZero($event)" maxlength="5" [disabled]="bci.bcicrDisable"
                                              [ngClass]="{'is-invalid': !bci.bcicrDisable && (bci.deductionPercentages == undefined || bci.deductionPercentages.toString() =='') }" 
                                              style="max-width: 120px !important;"
                                              disabled />
                                              <span class="input-group-text">%</span>
                                             </div>
                                           </div>
                                           <div class="col-sm-1" style="margin-left:-25px ;">
                                             <div class="input-group">
                                                <div class="btn-group">
                                                  <button 
                                                    class="btn btn-sm btn-outline-secondary" 
                                                    *ngIf="bci.bcicrDisable"
                                                    (click)="bci.bcicrDisable = false">
                                                    <i class="fas fa-edit"></i>
                                                  </button>
                                                <button class="btn btn-sm btn-outline-secondary" *ngIf="bci.bcicrDisable" (click)="deleteRefundRule(bci)">
                                                  <i class="fas fa-trash" style="color: red;"></i>
                                                </button>
                                                  <button 
                                                    class="btn btn-sm btn-outline-secondary" 
                                                    *ngIf="!bci.bcicrDisable"
                                                    (click)="beforeCheckInCRfUpDate(n)">
                                                    <i class="fas fa-check"></i>
                                                  </button>
                                                  <button 
                                                    class="btn btn-sm btn-outline-secondary" 
                                                    *ngIf="!bci.bcicrDisable"
                                                    (click)="beforeCheckInCRfReset(n)">
                                                    <i class="fas fa-redo" style="color: red;"></i>
                                                  </button>
                                                </div>
                                               </div>
                                             </div>
                                         </div> -->
                                       </div>
                                       <div>
                                        <div class="d-flex mb-1" style="margin-top:-30px;">
                                          <div></div>
                                          <div class="ml-auto mr-1">
                                            <span style="color: red; font-size: 14px; margin-top: 15px;" >{{!canSubmit ? 'Data will be saved to the database only after clicking the update button.':''}}</span>
                                            <button type="button" class="btn btn-sm btn-primary" [disabled]="canSubmit" (click)="beforeCheckInCRfUpDate()">Update</button>
                                            <button class="btn btn-sm btn-outline-secondary ml-1" (click)="beforeCheckInCRDatafReset()"  ><i class="fas fa-redo" style="color: red;"></i></button>
                                          </div>
                                        </div>
                                        <mat-table [dataSource]="dataSource"
                                                    #table
                                                    class="example-list"
                                                    cdkDropList
                                                    [cdkDropListData]="dataSource.data"
                                                    (cdkDropListDropped)="drop($event)">
                        
                                          <ng-container matColumnDef="condName" class="example-box">
                                            <!-- <mat-header-cell  *matHeaderCellDef ></mat-header-cell> -->
                                            <mat-cell data-label="condName" *matCellDef="let element" style="width: 120px;flex:none;padding-right: 0px;" [ngClass]="element.isDelete? 'example-box row-strike' :'example-box'"  >
                                            <span > {{ element.sequenceOrder }} </span> 
                                              <div class="ml-1" *ngIf="!element.isEdit || element.isDelete" >
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="element.condName" [disabled]="!element.isEdit || element.isDelete" style="width: 80px !important;" /> 
                                              </div> 
                                              <div class="ml-1" *ngIf="!element.isDelete && element.isEdit" >
                                                <select class="form-select form-select-sm" style="width: 80px !important;"  [(ngModel)]="element.condName">
                                                <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                                </select>
                                              </div>
                                             </mat-cell>
                                          </ng-container>
                                        
                                          <ng-container matColumnDef="daysBeforeCheckIn" class="example-box">
                                            <!-- <mat-header-cell *matHeaderCellDef ></mat-header-cell> -->
                                            <mat-cell data-label="daysBeforeCheckIn" *matCellDef="let element" style="width: 154px;flex: none;padding-right: 0px;" [ngClass]="element.isDelete? 'example-box row-strike' :'example-box'" > 
                                              <div class="d-flex input-group input-group-sm">
                                                <input type="text" 
                                                        class="form-control form-control-sm"
                                                        [(ngModel)]="element.daysBeforeCheckIn" (keypress)="numberOnly($event)" maxlength="3" [disabled]="element.isDelete || !element.isEdit"
                                                        [ngClass]="{'is-invalid': !element.isDelete && element.isEdit && (element.daysBeforeCheckIn == 0 || !element.daysBeforeCheckIn) }" 
                                                        style="max-width: 84px !important;" />
                                                <span class="input-group-text">Days</span>
                                              </div>
                                              </mat-cell>
                                          </ng-container>
                                          
                                          <ng-container matColumnDef="triggerOn" class="example-box">
                                            <!-- <mat-header-cell *matHeaderCellDef ></mat-header-cell> -->
                                            <mat-cell data-label="requirePayslip" *matCellDef="let element"  style="width: 210px;padding-right: 0px;flex: none;" [ngClass]="element.isDelete? 'example-box row-strike' :'example-box'" > 
                                              <div *ngIf="!element.isEdit || element.isDelete">
                                                <input type="text" class="form-control form-control-sm" [(ngModel)]="element.triggerOn" [disabled]="!element.isEdit || element.isDelete" style="width: 190px !important;"/> 
                                              </div>
                                              <div *ngIf="!element.isDelete && element.isEdit" >
                                                <select class="form-select form-select-sm" [(ngModel)]="element.triggerOn" style="width: 190px !important;" >
                                                <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                                </select>
                                              </div>
                                            </mat-cell>
                                          </ng-container>

                                          <ng-container matColumnDef="deductionPercentages" class="example-box">
                                            <!-- <mat-header-cell  *matHeaderCellDef ></mat-header-cell> -->
                                            <mat-cell data-label="requirePayslip" *matCellDef="let element"  style="width: 150px !important;flex:none;padding-right: 0px;" [ngClass]="element.isDelete? 'example-box row-strike' :'example-box'"> 
                                              <div class="d-flex input-group input-group-sm">
                                                <input  type="text" 
                                                        class="form-control form-control-sm"
                                                        [(ngModel)]="element.deductionPercentages" (keypress)="percentageOnlyWithZero($event)" maxlength="5" [disabled]="element.isDelete || !element.isEdit"
                                                        [ngClass]="{'is-invalid': !element.isDelete && element.isEdit && (element.deductionPercentages == undefined || element.deductionPercentages.toString() =='') }" 
                                                        style="max-width: 90px !important;"
                                                        disabled />
                                                <span class="input-group-text">%</span>
                                               </div>                                              
                                            </mat-cell>
                                          </ng-container>
                                        
                                          <ng-container matColumnDef="action" class="example-box">
                                            <!-- <mat-header-cell *matHeaderCellDef></mat-header-cell> -->
                                            <mat-cell data-label="action" *matCellDef="let element ;let i=index"  style="padding-left:0px;flex:none;" [ngClass]="element.isDelete? 'example-box row-strike' :'example-box'">
                                              <div class="input-group">
                                                <div class="btn-group">
                                                  <button class="btn btn-sm btn-outline-secondary"  *ngIf="!element.isDelete && !element.isEdit"
                                                    (click)="element.isEdit = true;" title="Edit The Item"> 
                                                     <i class="fas fa-edit"></i>
                                                  </button>
                                                <button class="btn btn-sm btn-outline-secondary" *ngIf="!element.isDelete && !element.isEdit" 
                                                    (click)="beforeCheckInCRfDelete(element,i)" title="Delete The Item"> 
                                                    <i class="fas fa-trash" style="color: red;"></i>
                                                </button>
                                                  <button class="btn btn-sm btn-outline-secondary" *ngIf="!element.isDelete && element.isEdit"
                                                    (click)="beforeCheckInCRfModify(element)" title="Edit The Item">
                                                     <i class="fas fa-check"></i>
                                                  </button>
                                                  <button class="btn btn-sm btn-outline-secondary" *ngIf="!element.isDelete && element.isEdit"
                                                    (click)="undoEditItem(element,i)" title="Undo Edit Item">
                                                    <i class="fas fa-redo" style="color: red;"></i>
                                                  </button>
                                                  <button class="btn btn-sm btn-outline-secondary" *ngIf="element.isDelete"
                                                    (click)="undoDelete(element)" title="Undo Delete Item">
                                                    <i class="fas fa-redo" style="color: red;" ></i>
                                                  </button>
                                                </div>
                                               </div>
                                            </mat-cell>
                                            
                                          </ng-container>          
                                          <!-- <mat-header-row *matHeaderRowDef="displayedColumns"></mat-header-row> -->
                                          <mat-row *matRowDef="let row; columns: displayedColumns;" cdkDrag></mat-row>
                                        </mat-table>
                                      <!-- </div> -->
                                        <div cdkDropList [cdkDropListData]="dataSource.data" (cdkDropListDropped)="drop($event)"></div>
                                    </div>
                                    </div>
                                  </div>
                                </div>
                                <!--div style="background-color: #c1a1f3; padding: 5px;" class="mt-2">
                                  <i class="far mr-2 ml-2" [ngClass]="collaspeListRight[1].selected ? 'fa fa-angle-down' : 'fa fa-angle-up'" style="cursor: pointer;" data-bs-toggle="collapse" data-bs-target="#collapseExampleRight1" aria-expanded="false" aria-controls="collapseExampleRight1" (click)="collaspeExpandPanelRight(collaspeListRight[1],'right2')"></i>
                                  After Check in for Refund Rent 
                                </div -->
                                <!--div class="collapse" [ngClass]="collaspeListRight[1].selected ? 'show':''" id="collapseExampleRight1">
                                  <div class="card card-body m-0 p-0 ">
                                    <div class="pl-3 pr-3">
                                      <div>
                                        <div class="row">
                                         <div class="col-sm-5">
                                           <div>Days after check in</div>
                                           <div class="input-group input-group-sm">
                                            <input 
                                                type="text" 
                                                class="form-control form-control-sm"
                                                style="max-width: 100px !important;"
                                                />
                                                <span class="input-group-text">Days</span>
                                           </div>
                                           <p class="small" style="font-size: 12px;color: gray">The maximum Number of days allowing tenants to get refunf of rent amount in prorate basis id not happy with the current PG.</p>
                                           </div>
                                           <div class="col-sm-2">
                                             <div>Actions</div>
                                             <div>
                                               <button type="submit" class=" btn btn-sm btn-primary">Save</button>
                                             </div>
                                           </div>
                                        </div>
                                       </div>
                                     </div>
                                  </div>
                                </div -->
                             </div>
                           </div>
                        </div>
                        <hr class="solid">
                        <!--Security Deposite Refund rules-->
                        <div>
                          <!--Total Advance section-->
                          <div class="row p-3 align-items-center marginRow">
                            <div class="col-sm-3">
                              <div><span style="font-size: 16px;">Early Check-out Rules</span></div>
                              <div><p class="small text-muted" style="font-size: 12px;"><em>The Maximim Number of days allowing tenants to get refund of rent amount in prorate basis if not happy with the current PG.</em></p></div>
                            </div>
                            
                            <div class="col-sm-9">
                              <div class="row">
                                <div class="col-sm-2">
                                  <div>Condition</div>
                                  <div class="input-group input-group-sm" *ngIf="securityDepositRefundDisabled">
                                    <input type="text" class="form-control form-control-sm" value="==" [disabled]="securityDepositRefundDisabled" /> 
                                  </div> 
                                  <div class="input-group input-group-sm" *ngIf="!securityDepositRefundDisabled">
                                    <select class="form-select form-select-sm">
                                      <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                    </select>
                                  </div>
                                 </div>
                                <div class="col-sm-3">
                                  <div>Days for Refund</div>
                                  <div class="input-group input-group-sm">
                                    <input 
                                      type="text" 
                                      class="form-control form-control-sm" 
                                      [(ngModel)]="configMasterModel.refundRules.maximumDays" [disabled]="securityDepositRefundDisabled" (keypress)="numberOnly($event)" maxlength="3"
                                       [ngClass]="{'is-invalid': !securityDepositRefundDisabled && (configMasterModel.refundRules.maximumDays == 0 || !configMasterModel.refundRules.maximumDays) }" 
                                      style="max-width: 70px !important;" />
                                      <span class="input-group-text">Days</span>
                                  </div>
                                  <p class="small text-muted" style="font-size: 12px;">
                                  <em>Enter maximum days for refund.</em>
                                  </p>
                                </div>
                                <div class="col-sm-3">
                                  <div>Deduction Type</div>
                                  <div class="input-group input-group-sm" *ngIf="securityDepositRefundDisabled">
                                    <input type="text" class="form-control form-control-sm" value="PaidAmount & Rent" [disabled]="securityDepositRefundDisabled" /> 
                                  </div>
                                  <div class="input-group input-group-sm" *ngIf="!securityDepositRefundDisabled">
                                    <select class="form-select form-select-sm">
                                    <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                    </select>
                                  </div>
                                  <!-- <div class="input-group input-group-sm" style="padding-top:5px;color:gray;" *ngIf="securityDepositRefundDisabled">Paid Amount & Rent</div>
                                  <div class="input-group input-group-sm" *ngIf="!securityDepositRefundDisabled">
                                    <select 
                                    class="form-select form-select-sm" 
                                    >
                                    <option value="PaidAmount">Paid Amount</option>
                                    <option value="Rent">Rent</option>
                                    <option value="PaidAmount & Rent">Paid Amount & Rent</option>
                                    </select>
                                  </div> -->
                                </div>
                                <div class="col-sm-3">
                                  <div>Platform charges</div>
                                      <div class="input-group input-group-sm" >
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm" 
                                          [(ngModel)]="configMasterModel.refundRules.plotformCharges"  (keypress)="percentageOnly($event)" maxlength="5"
                                          [ngClass]="{'is-invalid': !securityDepositRefundDisabled && ( configMasterModel.refundRules.plotformCharges == 0 || !configMasterModel.refundRules.plotformCharges)}" 
                                          style="max-width: 70px !important;" [disabled]="securityDepositRefundDisabled" />
                                         <span class="input-group-text">%</span>
                                  </div>
                                  <p class="small text-muted" style="font-size: 12px;"><em>Enter deduction percentage from security deposit.</em></p>
                      
                                </div>
                                <div class="col-sm-1 mt-4" style="margin-left:-14px ;">
                                    <div *ngIf="securityDepositRefundDisabled">
                                      <button class="btn btn-sm btn-outline-secondary" (click)="securityDepositRefundDisabled = false">
                                        <i class="fas fa-edit"></i>
                                      </button>
                                    </div>
                                    <div class="btn-group" *ngIf="!securityDepositRefundDisabled">
                                      <button class="btn btn-sm btn-outline-secondary" (click)="securityDepositRefundSubmit()">
                                        <i class="fas fa-check"></i>
                                      </button>
                                      <button class="btn btn-sm btn-outline-secondary" (click)="securityDepositRefundReset()">
                                        <i class="fas fa-redo" style="color: red;"></i>
                                      </button>
                                    </div>
                                </div>
                              </div>
                                 </div>
                          </div>
                        </div>
                      
                            <hr class="solid"> 
                            <div>
                              <!--Auto-Cancellation Period-->
                              <div class="row p-3 align-items-center marginRow">
                                <div class="col-sm-3">
                                  <div><span style="font-size: 16px;">Auto-Cancellation Period </span></div>
                                  <div>
                                    <p class="small text-muted" style="font-size: 12px;">
                                    <em>Configure the number of days after the check-in date to automatically cancel bookings if tenants fail to check-in.</em>
                                    </p>
                                  </div>
                                </div>
                                <div class="col-sm-9">
                                  <div class="row">
                                    <!-- Auto-Cancellation after Check-in Dates -->
                                    <div class="col-sm-2">
                                      <div>Condition</div>
                                      <div class="input-group input-group-sm" *ngIf="securityDepositLimitsDisabled">
                                        <input type="text" class="form-control form-control-sm" value="==" [disabled]="securityDepositRefundDisabled" /> 
                                      </div> 
                                      <div class="input-group input-group-sm" *ngIf="!securityDepositLimitsDisabled">
                                        <select class="form-select form-select-sm">
                                          <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                        </select>
                                      </div>
                                     </div>
                                    <div class="col-sm-3">
                                      <div>Auto-Cancellation Dates</div>
                                      <div class="input-group input-group-sm">
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm"
                                          [(ngModel)]="configMasterModel.depositDetails.minimumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="9"
                                           [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.minimumDeposit == 0 || !configMasterModel.depositDetails.minimumDeposit) }" 
                                          style="max-width: 70px !important;" />
                                          <span class="input-group-text">Days</span>
                                      </div>
                                      <p class="small text-muted" style="font-size: 12px;">
                                      <em>Set the days to cancel if not checked in.</em>
                                      </p>
                                    </div>
                                    <div class="col-sm-3">
                                      <div>Deduction Type</div>
                                      <div class="input-group input-group-sm" *ngIf="securityDepositLimitsDisabled">
                                        <input type="text" class="form-control form-control-sm" value="PaidAmount & Rent" [disabled]="securityDepositRefundDisabled" /> 
                                      </div>
                                      <div class="input-group input-group-sm" *ngIf="!securityDepositLimitsDisabled">
                                        <select class="form-select form-select-sm">
                                        <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                        </select>
                                      </div>
                                    </div>
                                    <!-- Deduction Percentage -->
                                    <div class="col-sm-2">
                                      <div>Deduction</div>
                                      <div class="input-group input-group-sm">
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm"
                                          [(ngModel)]="configMasterModel.depositDetails.maximumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="8"
                                           [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.maximumDeposit == 0 || !configMasterModel.depositDetails.maximumDeposit) }" 
                                          style="max-width: 70px !important;"/>
                                          <span class="input-group-text">%</span>
                                      </div>
                                      <p class="small text-muted" style="font-size: 12px;">
                                      <em>Percentage of paid amount to deduct.</em>
                                      </p>
                                    </div>
                                    <!-- Action Button -->
                                    <div class="col-sm-1 mt-4">
                                      <div class="btn-group">
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsDisabled = false">
                                          <i class="fas fa-edit"></i>
                                        </button>
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="!securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsSubmit()">
                                          <i class="fas fa-check"></i>
                                        </button>
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="!securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsReset()">
                                          <i class="fas fa-redo" style="color: red;"></i>
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                              
                            </div>
                            <hr class="solid"> 
                            <div>
                              <!--Security Deposite Deadline-->
                              <div class="row p-3 align-items-center marginRow">
                                <div class="col-sm-3">
                                  <div><span style="font-size: 16px;">Security Deposite Deadline</span></div>
                                  <div>
                                    <p class="small text-muted" style="font-size: 12px;">
                                    <em>Configure the number of days to collect security deposite amount before check-in date to avoid auto cancellation.</em>
                                    </p>
                                  </div>
                                </div>
                                <div class="col-sm-9">
                                  <div class="row">
                                    <!-- Auto-Cancellation after Check-in Dates -->
                                    <div class="col-sm-2">
                                      <div>Condition</div>
                                      <div class="input-group input-group-sm" *ngIf="securityDepositLimitsDisabled">
                                        <input type="text" class="form-control form-control-sm" value="==" [disabled]="securityDepositRefundDisabled" /> 
                                      </div> 
                                      <div class="input-group input-group-sm" *ngIf="!securityDepositLimitsDisabled">
                                        <select class="form-select form-select-sm">
                                          <option *ngFor="let cond of conditions" [value]="cond">{{cond}}</option>
                                        </select>
                                      </div>
                                     </div>
                                    <div class="col-sm-3">
                                      <div>Auto-Cancellation Dates</div>
                                      <div class="input-group input-group-sm">
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm"
                                          [(ngModel)]="configMasterModel.depositDetails.minimumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="9"
                                           [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.minimumDeposit == 0 || !configMasterModel.depositDetails.minimumDeposit) }" 
                                          style="max-width: 70px !important;" />
                                          <span class="input-group-text">Days</span>
                                      </div>
                                      <p class="small text-muted" style="font-size: 12px;">
                                      <em>Set the days to collect deposite before auto cancellation.</em>
                                      </p>
                                    </div>
                                    <div class="col-sm-3">
                                      <div>Deduction Type</div>
                                      <div class="input-group input-group-sm" *ngIf="securityDepositLimitsDisabled">
                                        <input type="text" class="form-control form-control-sm" value="PaidAmount & Rent" [disabled]="securityDepositRefundDisabled" /> 
                                      </div>
                                      <div class="input-group input-group-sm" *ngIf="!securityDepositLimitsDisabled">
                                        <select class="form-select form-select-sm">
                                        <option *ngFor="let trigger of triggerOn" [value]="trigger">{{trigger}}</option>
                                        </select>
                                      </div>
                                    </div>
                                     <!-- Deduction Percentage -->
                                     <div class="col-sm-2">
                                      <div>Deduction</div>
                                      <div class="input-group input-group-sm">
                                        <input 
                                          type="text" 
                                          class="form-control form-control-sm"
                                          [(ngModel)]="configMasterModel.depositDetails.maximumDeposit" [disabled]="securityDepositLimitsDisabled" (keypress)="numberOnly($event)" maxlength="8"
                                           [ngClass]="{'is-invalid': !securityDepositLimitsDisabled && (configMasterModel.depositDetails.maximumDeposit == 0 || !configMasterModel.depositDetails.maximumDeposit) }" 
                                          style="max-width: 70px !important;"/>
                                          <span class="input-group-text">%</span>
                                      </div>
                                      <p class="small text-muted" style="font-size: 12px;">
                                      <em>Percentage of paid amount to deduct.</em>
                                      </p>
                                    </div>
                                   
                                    <!-- Action Button -->
                                    <div class="col-sm-1 mt-4">
                                      <div class="btn-group">
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsDisabled = false">
                                          <i class="fas fa-edit"></i>
                                        </button>
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="!securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsSubmit()">
                                          <i class="fas fa-check"></i>
                                        </button>
                                        <button 
                                          class="btn btn-sm btn-outline-secondary" 
                                          *ngIf="!securityDepositLimitsDisabled"
                                          (click)="securityDepositLimitsReset()">
                                          <i class="fas fa-redo" style="color: red;"></i>
                                        </button>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                            <hr class="solid">
                            <!--Other Charges-->
                            <div>
                              <div class="row p-3 align-items-center marginRow">
                                  <div class="col-sm-3">
                                    <span style="font-size: 16px;">Other Charges</span>
                                    <p class="small text-muted" style="font-size: 12px;"><em>Configure documentation charges for Owners and Tenants.</em></p>
                                  </div>
                                  <div class="col-sm-9">
                                    <div class="row">
                                      <!-- GST Section -->
                                      <div class="col-sm-5">
                                        <div>Documentation Charges for Owners</div>
                                        <div class="input-group input-group-sm">
                                          <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                          <input 
                                            type="text" 
                                            class="form-control form-control-sm" 
                                            [(ngModel)]="tempGSTValue" 
                                            style="max-width: 100px !important;" 
                                            [disabled]="gstHidden" />
                                          <div class="pl-4">
                                            <div *ngIf="gstHidden">
                                              <button class="btn btn-sm btn-outline-secondary" (click)="editGST()">
                                                <i class="fas fa-edit"></i>
                                              </button>
                                            </div>
                                            <div class="btn-group" *ngIf="!gstHidden">
                                              <button class="btn btn-sm btn-outline-secondary" (click)="submitGST()">
                                                <i class="fas fa-check"></i>
                                              </button>
                                              <button class="btn btn-sm btn-outline-secondary" (click)="resetGST()">
                                                <i class="fas fa-redo" style="color: red;"></i>
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <p class="small text-muted mt-1" style="font-size: 12px;">
                                        <em>Enter the one time amount to be charged to Owners for documentation purpose.</em>
                                        </p>
                                      </div>
                                      <!-- Documentation Charges Section -->
                                      <div class="col-sm-5">
                                        <div>Documentation Charges for Tenants</div>
                                        <div class="input-group input-group-sm">
                                          <span class="input-group-text"><i class="fas fa-rupee-sign"></i></span>
                                          <input 
                                            type="text" 
                                            class="form-control form-control-sm" 
                                            [(ngModel)]="tempGSTValue" 
                                            style="max-width: 100px !important;" 
                                            [disabled]="gstHidden" />
                                           
                                          <div class="pl-4">
                                            <div *ngIf="gstHidden">
                                              <button class="btn btn-sm btn-outline-secondary" (click)="editGST()">
                                                <i class="fas fa-edit"></i>
                                              </button>
                                            </div>
                                            <div class="btn-group" *ngIf="!gstHidden">
                                              <button class="btn btn-sm btn-outline-secondary" (click)="submitGST()">
                                                <i class="fas fa-check"></i>
                                              </button>
                                              <button class="btn btn-sm btn-outline-secondary" (click)="resetGST()">
                                                <i class="fas fa-redo" style="color: red;"></i>
                                              </button>
                                            </div>
                                          </div>
                                        </div>
                                        <p class="small text-muted mt-1" style="font-size: 12px;">
                                        <em>Enter the one time amount to be charged to Tenants for documentation purpose.</em>
                                        </p>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                            </div>
                    
                        <hr class="solid">
                        <!--Data Grouping-->
                        <div>
                          <div class="row p-3 align-items-center marginRow">
                            <div class="col-sm-3">
                              <span style="font-size: 16px;">Data Grouping</span>
                            </div>
                            <div class="col-sm-9">
                             <div class="row">
                                <span>Trending PG Configuration</span>
                                <div class="col-sm-3">
                                <div class="input-group input-group-sm">
                                  <input 
                                  type="text" 
                                  class="form-control form-control-sm"
                                  [(ngModel)]="configMasterModel.dataGrouping.considerDays" [disabled]="dataGroupingDisabled" (keypress)="numberOnly($event)" maxlength="3"
                                  [ngClass]="{'is-invalid': !dataGroupingDisabled && (configMasterModel.dataGrouping.considerDays == 0 || !configMasterModel.dataGrouping.considerDays) }" 
                                  style="max-width: 70px !important;" />
                                  <span class="input-group-text">Days</span>
                                </div>
                                </div>
                                <div class="col-sm-2">
                                  <div *ngIf="dataGroupingDisabled">
                                    <button class="btn btn-sm btn-outline-secondary" (click)="dataGroupingDisabled = false">
                                      <i class="fas fa-edit"></i>
                                    </button>
                                  </div>
                                  <div class="btn-group" *ngIf="!dataGroupingDisabled">
                                    <button class="btn btn-sm btn-outline-secondary" (click)="trendingPGSubmit()">
                                      <i class="fas fa-check"></i>
                                    </button>
                                    <button class="btn btn-sm btn-outline-secondary" (click)="trendingPGReset()">
                                      <i class="fas fa-redo" style="color: red;"></i>
                                    </button>
                                  </div>
                              </div>
                                </div>
                             <div>
                              <p class="small text-muted" style="font-size: 12px;"><em>Specify the number of days that is to be considered for showing trending PG's to Tenants.</em></p>
                            </div>
                            </div>
                          </div>
                        </div>
                   </div>
                  </div>
                <!-- /.container-fluid -->
            </div>
            <!-- End of Main Content -->
        </div>
        <!-- End of Content Wrapper -->
   </div>
  <!-- End of Page Wrapper -->
</div>



